import{_ as g}from"./form-input-3d77d476.js";import{_ as N}from"./table-7740b1a4.js";import{_ as w}from"./button-27af24b8.js";import{L as $}from"./loading-06b58b27.js";import{u as B}from"./employee-cd2d0331.js";import{u as D}from"./employer-327c1d65.js";import{j as F,r as c,g as I,h as x,i as m,o as d,c as n,e,d as i,f as _,b as A,k as y,F as T}from"./index-ae08a8a1.js";import"./input-57f3c635.js";const V={key:0},L={class:"mb-5"},R={key:0},j={key:1},U={__name:"index",setup(M){var E;const p=B(),r=D(),f=F();let o=(E=f==null?void 0:f.params)==null?void 0:E.id,t=c(!1),l=c(!1),a=c(!0),v=I(()=>p.employee),k=I(()=>r.employer),h=c({firstName:"",lastName:"",date:"",placeOfBirth:"",age:"",marital:"",employerId:"",nationality:"",gender:"",workType:"",tm6:"",checkpoint:"",passportId:"",issuedAt:"",start:"",end:"",visaType:"",passportIdOld:"",issuedAtOld:"",startOld:"",endOld:"",visaTypeOld:"",port:"",portDate:"",transportation:"",form:"",reason:"",employeeId:o}),C=async()=>{a.value=!0;try{await p.patchEmployee(o,v.value),await r.fetchEmployer(o),await p.fetchEmployeeId(o),a.value=!1,m("Success",{autoClose:5e3,type:"success"})}catch(s){a.value=!1,m(s.message,{autoClose:5e3,type:"error"})}},S=async s=>{a.value=!0;try{await r.deleteEmployer(s),await r.fetchEmployer(s),await p.fetchEmployeeId(s),a.value=!1,m("Success",{autoClose:5e3,type:"success"})}catch(u){a.value=!1,m(u.message,{autoClose:5e3,type:"error"})}},b=async()=>{a.value=!0;try{await r.postEmployer(h.value),await r.fetchEmployer(o),await p.fetchEmployeeId(o),t.value=!1,a.value=!1,m("Success",{autoClose:5e3,type:"success"})}catch(s){t.value=!1,a.value=!1,m(s.message,{autoClose:5e3,type:"error"})}};return x(async()=>{try{await p.fetchEmployeeId(o),await r.fetchEmployer(o),a.value=!1}catch(s){a.value=!1,m(s.message,{autoClose:5e3,type:"error"})}}),(s,u)=>(d(),n(T,null,[e(a)?(d(),n("div",V,[i($)])):_("",!0),A("div",L,[i(w,{type:"primary",msg:"แก้ไขข้อมูล / Edit employee",onClick:u[0]||(u[0]=O=>e(l)===!1?y(l)?l.value=!0:l=!0:y(l)?l.value=!1:l=!1)}),e(l)?(d(),n("div",R,[i(g,{data:e(v),onSubmit:e(C),edit:""},null,8,["data","onSubmit"])])):_("",!0)]),i(w,{type:"primary-line",msg:"เพิ่มลูกจ้าง / Add employer",onClick:u[1]||(u[1]=O=>e(t)===!1?y(t)?t.value=!0:t=!0:y(t)?t.value=!1:t=!1)}),e(t)?(d(),n("div",j,[i(g,{data:e(h),onSubmit:e(b),employer:""},null,8,["data","onSubmit"])])):_("",!0),i(N,{data:e(k),onDeleteItem:e(S),employee:e(v),id:e(o),employer:""},null,8,["data","onDeleteItem","employee","id"])],64))}};export{U as default};
