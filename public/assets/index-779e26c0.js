import{_ as h}from"./form-input-329611a2.js";import{_ as S}from"./table-ce0a312e.js";import{_ as E}from"./button-f840e959.js";import{u as D,L as $}from"./employer-e335ad34.js";import{u as B}from"./employee-eabfc88c.js";import{d as C,r as d,a as w,b as F,o as c,e as f,u as e,f as i,g as I,i as u,h as x,n as A,F as T}from"./index-dbd23a5d.js";const V={key:0},L={key:1},J={__name:"index",setup(R){var _;const m=B(),s=D(),y=C();let t=(_=y==null?void 0:y.params)==null?void 0:_.id,a=d(!1),o=d(!1),l=d(!0),n=w(()=>m.employee),g=w(()=>s.employer),v=d({firstName:"",lastName:"",date:"",placeOfBirth:"",age:"",marital:"",employerId:"",nationality:"",gender:"",workType:"",tm6:"",checkpoint:"",passportId:"",issuedAt:"",start:"",end:"",visaType:"",passportIdOld:"",issuedAtOld:"",startOld:"",endOld:"",visaTypeOld:"",port:"",portDate:"",transportation:"",form:"",reason:"",employeeId:n.value.id}),k=async()=>{l.value=!0;try{await m.patchEmployee(t,n.value),await s.fetchEmployer(t),await m.fetchEmployeeId(t),l.value=!1}catch{}},b=async r=>{l.value=!0;try{await s.deleteEmployer(r),await s.fetchEmployer(r),await m.fetchEmployeeId(r),l.value=!1}catch(p){console.log(p)}},N=async()=>{l.value=!0;try{await s.postEmployer(v.value),await s.fetchEmployer(t),await m.fetchEmployeeId(t),a.value=!1,l.value=!1}catch{a.value=!1}};return F(async()=>{try{await m.fetchEmployeeId(t),await s.fetchEmployer(t),l.value=!1}catch(r){console.error("No employee ID found in route params.",r)}}),(r,p)=>(c(),f(T,null,[e(l)?(c(),f("div",V,[i($)])):I("",!0),i(E,{type:"primary",msg:"แก้ไขข้อมูล / Edit employee",onClick:p[0]||(p[0]=O=>e(o)===!1?u(o)?o.value=!0:o=!0:u(o)?o.value=!1:o=!1)}),x("div",{class:A({"opacity-60 pointer-events-none":!e(o)})},[i(h,{data:e(n),onSubmit:e(k),edit:""},null,8,["data","onSubmit"])],2),i(E,{type:"primary-line",msg:"เพิ่มลูกจ้าง / Add employer",onClick:p[1]||(p[1]=O=>e(a)===!1?u(a)?a.value=!0:a=!0:u(a)?a.value=!1:a=!1)}),e(a)?(c(),f("div",L,[i(h,{data:e(v),onSubmit:e(N),employer:""},null,8,["data","onSubmit"])])):I("",!0),i(S,{data:e(g),onDeleteItem:e(b),employee:e(n),id:e(t),employer:""},null,8,["data","onDeleteItem","employee","id"])],64))}};export{J as default};
